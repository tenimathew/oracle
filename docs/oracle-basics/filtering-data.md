---
id: Section 3. Filtering data
sidebar_position: 3
description: DISTINCT, WHERE, FETCH, Operators
---

## DISTINCT

The `DISTINCT` clause is used in a `SELECT` statement to filter duplicate rows in the result set. It ensures that rows returned are unique for the column or columns specified in the `SELECT` clause.

The `DISTINCT` treats `NULL` values to be duplicates of each other. If you use the `SELECT DISTINCT` statement to query data from a column that has many `NULL` values, the result set will include only one NULL value.

### Syntax

```sql
SELECT DISTINCT column_1
FROM table_name;
```

## WHERE

### Syntax

```sql
SELECT column_1
FROM table_name
WHERE search_condition;
```

Besides the `SELECT` statement, you can use the `WHERE` clause in the `DELETE` or `UPDATE` statement to specify which rows to update or delete.

## FETCH

Some RDBMS such as MySQL and PostgreSQL have the `LIMIT` clause that allows you to retrieve a portion of rows generated by a query.

```sql
SELECT product_name, quantity
FROM inventorie INNER JOIN products USING(product_id)
ORDER BY quantity DESC
LIMIT 5;
```

Oracle Database does not have the `LIMIT` clause. However, since 12c release, it provided a similar but more flexible clause named row limiting clause.

```sql
SELECT product_name, quantity
FROM inventories INNER JOIN products USING(product_id)
ORDER BY quantity DESC
FETCH NEXT 5 ROWS ONLY;
```

### Syntax

```sql
[OFFSET offset ROWS]
FETCH  NEXT [row_count | percent PERCENT] ROWS  [ONLY | WITH TIES]
```

### OFFSET clause

- `OFFSET` clause specifies the number of rows to skip before the row limiting starts.
- The `OFFSET` clause is optional. If you skip it, then offset is 0 and row limiting starts with the first row
- If the offset is negative, then it is treated as 0.
- If the offset is NULL or greater than the number of rows returned by the query, then no row is returned.
- If the offset includes a fraction, then the fractional portion is truncated.

### FETCH clause

For the semantic clarity purpose, you can use the keyword `ROW` instead of `ROWS`, `FIRST` instead of `NEXT`

```sql
FETCH NEXT 1 ROWS
FETCH FIRST 1 ROW
```

### ONLY | WITH TIES

- The `ONLY` returns exactly the number of rows or percentage of rows
- `WITH TIES` returns additional rows with the same sort key as the last row fetched
- if you use `WITH TIES`, you must specify an `ORDER BY` clause in the query. If you don’t, the query will not return the additional rows.

### Examples

```sql
SELECT product_name, quantity
FROM inventories INNER JOIN products USING(product_id)
ORDER BY quantity DESC
FETCH NEXT 10 ROWS ONLY;
```

```sql
SELECT product_name, quantity
FROM inventories INNER JOIN products USING(product_id)
ORDER BY quantity DESC
FETCH NEXT 10 ROWS WITH TIES;
```

```sql
SELECT product_name, quantity
FROM inventories INNER JOIN products USING(product_id)
ORDER BY quantity DESC
FETCH FIRST 5 PERCENT ROWS ONLY;
```

```sql
SELECT product_name, quantity
FROM inventories INNER JOIN products USING(product_id)
ORDER BY quantity DESC
OFFSET 10 ROWS
FETCH NEXT 10 ROWS ONLY;
```

## Oracle Operators

AND, OR, IN, NOT IN, BETWEEN, LIKE, NOT LIKE, IS NULL, IS NOT NULL

| Operator | Description              |
| -------- | ------------------------ |
| =        | Equality                 |
| \!=,<\>  | Inequality               |
| \>       | Greater than             |
| <        | Less than                |
| \>=      | Greater than or equal to |
| <=       | Less than or equal to    |

### LIKE wildcard Characters

- `%` (percent) matches any string of zero or more character.
- `_` (underscore) matches any single character.

### ESCAPE clause in LIKE

To search for the string `25%`, you use the `ESCAPE` clause as follows:

```sql
LIKE '%25!%%' ESCAPE '!'
```

If you don’t use the `ESCAPE` clause, Oracle will return any rows with the string `25`.

```sql
CREATE TABLE discounts
  (
    product_id NUMBER,
    discount_message VARCHAR2( 255 ) NOT NULL,
    PRIMARY KEY( product_id )
  );

INSERT INTO discounts(product_id, discount_message)
VALUES(1,'Buy 1 and Get 25% OFF on 2nd ');

INSERT INTO discounts(product_id, discount_message)
VALUES(2,'Buy 2 and Get 50% OFF on 3rd ');

INSERT INTO discounts(product_id, discount_message)
VALUES(3,'Buy 3 Get 1 free');
```

```sql
SELECT product_id, discount_message
FROM discounts
WHERE discount_message LIKE '%25!%%' ESCAPE '!';
```
